function [x3,y2]= PA_v2(rate)
x=[63.78725891 67.27060199 71.2565751 78.31467198 83.36801602 88.44209246 93.54512277 98.65530218 103.7997973 108.5072836 113.239474 118.4000546 123.5227449 128.6100472 133.649808 138.6974327 143.7740113 148.8763267 153.980072 159.077383 164.1796984 169.2863032 172.811437 174.1748604 175.6542781 177.9535193 180.8396125 185.0715245 188.9755905 190.9723948 191.9671926 193.4857337 197.1284881 201.7530845];
y=[0.562711864 0.657627119 0.479661017 0.565117486 0.572425658 0.576727631 0.576831293 0.575898335 0.569989601 0.560170505 0.546769311 0.538528182 0.535781139 0.538165365 0.547443114 0.555580582 0.559519738 0.559727062 0.559727062 0.56066002 0.560867344 0.560452696 0.553883117 0.541197479 0.528511841 0.514685921 0.499862254 0.491724786 0.497486666 0.510694933 0.527913193 0.549920636 0.559934386 0.562134324];
%hr=input('enter heart rate(bpm):')
r=1/(rate/60);
 %r=600 %length of one beat (ms)
len=x(end)-x(1);
d=r/len;
x=x*d;
x=x-x(1);

%figure(1)
%plot(x,y)
% beat_length=numel(x) % num data points per cycle
% f=beat_length/600 %samples per ms
% f1=(x(end)-x(1))/600

y(end)=y(1);
x2=x+(x(end)-x(1));
x3=[x x2];
y2=[y y];

%figure (2)
%plot(x3,y2)
%axis([0 2 0 0.9])
end

